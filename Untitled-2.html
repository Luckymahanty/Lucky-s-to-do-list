<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lucky's To-Do List</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif}
    body{background:linear-gradient(135deg,#10be5f 0%,#044d1c 100%);min-height:100vh;padding:20px;display:flex;align-items:center;justify-content:center}
    .todo-container{width:100%;max-width:550px;background:rgba(255,255,255,.98);border-radius:25px;box-shadow:0 30px 60px rgba(255,165,0,.3);overflow:hidden;border:4px solid #FFD700}
    .todo-header{background:linear-gradient(135deg,#FF8C00,#FFD700);padding:35px;text-align:center}
    .todo-header h1{font-size:2.5em;font-weight:700;color:#fff;margin-bottom:10px}
    .todo-header p{color:#FFF8DC}
    .go-badge{display:inline-block;background:#00ADD8;color:#fff;padding:8px 16px;border-radius:20px;margin-top:10px}
    .todo-input-container{padding:30px;background:#FFF8DC;border-bottom:3px solid #FFD700}
    .input-group{display:flex;gap:10px}
    .todo-input{flex:1;padding:15px;border:3px solid #FFD700;border-radius:12px}
    .add-btn{padding:15px 20px;background:linear-gradient(135deg,#FF8C00,#FFD700);color:#fff;border-radius:12px;font-weight:600}
    .todo-list{padding:20px;max-height:450px;overflow-y:auto}
    .todo-item{background:#FFFAF0;margin:10px 0;padding:15px;border-radius:12px;display:flex;align-items:center;justify-content:space-between;border:2px solid #FFD700}
    .todo-item.completed{background:#E8F5E8;border-color:#32CD32}
    .todo-item.completed .todo-text{text-decoration:line-through;color:#2E8B57}
    .todo-checkbox{width:25px;height:25px;border:3px solid #FFD700;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer}
    .todo-checkbox.checked{background:#32CD32;border-color:#32CD32;color:#fff}
    .delete-btn{color:#FF4500;border:none;cursor:pointer;background:none;font-size:18px}
    .todo-stats{padding:20px;border-top:3px solid #FFD700;background:#FFF8DC;text-align:center}
    .progress-bar{height:12px;background:#FFE4B5;border-radius:10px;overflow:hidden}
    .progress-fill{height:100%;background:linear-gradient(135deg,#FF8C00,#FFD700);transition:width .5s;width:0%}
  </style>
</head>
<body>
  <div class="todo-container">
    <div class="todo-header">
      <h1>üçÄ Lucky's To-Do List</h1>
      <p>Powered by Go Language Backend</p>
      <div class="go-badge"><i class="fab fa-golang"></i> Go Powered</div>
    </div>

    <div class="todo-input-container">
      <div class="input-group">
        <input type="text" class="todo-input" id="todoInput" placeholder="What brings you luck today?...">
        <button class="add-btn" id="addBtn"><i class="fas fa-plus-circle"></i> Add</button>
      </div>
    </div>

    <div class="todo-list" id="todoList"></div>

    <div class="todo-stats">
      <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
      <p id="statsText">üéØ 0 of 0 tasks completed</p>
    </div>
  </div>

  <script>
    const API_URL = "http://localhost:8080/api/todos";

    const LuckyTodoApp = {
      todos: [],
      async init() {
        document.getElementById("addBtn").addEventListener("click", () => this.addTodo());
        document.getElementById("todoInput").addEventListener("keypress", (e) => { if (e.key === "Enter") this.addTodo(); });
        await this.fetchTodos();
        this.render(); this.updateStats();
      },
      async fetchTodos() {
        const res = await fetch(API_URL);
        this.todos = await res.json();
      },
      async addTodo() {
        const input = document.getElementById("todoInput");
        const text = input.value.trim();
        if (!text) return;
        const res = await fetch(API_URL, {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify({ text })
        });
        const newTodo = await res.json();
        this.todos.unshift(newTodo);
        input.value = "";
        this.render(); this.updateStats();
      },
      async toggleComplete(id) {
        const todo = this.todos.find(t => t.id === id);
        const res = await fetch(`${API_URL}/${id}`, {
          method: "PUT",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify({ completed: !todo.completed })
        });
        const updated = await res.json();
        this.todos = this.todos.map(t => t.id === id ? updated : t);
        this.render(); this.updateStats();
      },
      async deleteTodo(id) {
        await fetch(`${API_URL}/${id}`, { method: "DELETE" });
        this.todos = this.todos.filter(t => t.id !== id);
        this.render(); this.updateStats();
      },
      render() {
        const list = document.getElementById("todoList");
        if (this.todos.length === 0) {
          list.innerHTML = `<p class="text-center text-gray-500 mt-4">No lucky tasks yet! üçÄ</p>`;
          return;
        }
        list.innerHTML = this.todos.map(todo => `
          <div class="todo-item ${todo.completed ? "completed" : ""}">
            <div class="todo-checkbox ${todo.completed ? "checked" : ""}" onclick="LuckyTodoApp.toggleComplete(${todo.id})">
              ${todo.completed ? "‚úì" : ""}
            </div>
            <div class="todo-text flex-1 ml-3">${todo.text}</div>
            <button class="delete-btn" onclick="LuckyTodoApp.deleteTodo(${todo.id})"><i class="fas fa-trash"></i></button>
          </div>
        `).join("");
      },
      updateStats() {
        const total = this.todos.length;
        const completed = this.todos.filter(t => t.completed).length;
        const percentage = total ? (completed / total) * 100 : 0;
        document.getElementById("progressFill").style.width = `${percentage}%`;
        document.getElementById("statsText").textContent = `üéØ ${completed} of ${total} tasks completed`;
      }
    };
    LuckyTodoApp.init();
  </script>
</body>
</html>
